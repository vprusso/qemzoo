<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 450 240">
  <style>
    .wire { stroke: #666; stroke-width: 1.5; fill: none; }
    .gate { stroke-width: 1.5; rx: 3; }
    .gate-param { fill: #5a8a5a; stroke: #3a6a3a; }
    .gate-fixed { fill: #7a7a9a; stroke: #5a5a7a; }
    .gate-text { fill: white; font-family: system-ui, sans-serif; font-size: 9px; text-anchor: middle; dominant-baseline: middle; }
    .label { fill: #333; font-family: system-ui, sans-serif; font-size: 11px; }
    .box { fill: #f5f5f5; stroke: #999; stroke-width: 1.5; rx: 6; }
    .arrow { stroke: #666; stroke-width: 1.5; fill: none; marker-end: url(#arrowhead); }
    .loop-arrow { stroke: #2a6a3a; stroke-width: 2; fill: none; marker-end: url(#arrowhead-green); }
  </style>

  <defs>
    <marker id="arrowhead" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#666"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#2a6a3a"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="225" y="20" text-anchor="middle" class="label" style="font-size: 14px; font-weight: 600;">VQE Hybrid Quantum-Classical Loop</text>

  <!-- Quantum Circuit Box -->
  <rect x="20" y="45" width="200" height="110" class="box"/>
  <text x="120" y="62" text-anchor="middle" class="label" style="font-size: 10px; fill: #666;">Quantum Circuit (Ansatz)</text>

  <!-- Qubit wires -->
  <line x1="35" y1="85" x2="205" y2="85" class="wire"/>
  <line x1="35" y1="115" x2="205" y2="115" class="wire"/>
  <line x1="35" y1="145" x2="205" y2="145" class="wire"/>

  <!-- Initial state -->
  <text x="40" y="85" class="label" style="font-size: 10px;">|0⟩</text>
  <text x="40" y="115" class="label" style="font-size: 10px;">|0⟩</text>
  <text x="40" y="145" class="label" style="font-size: 10px;">|0⟩</text>

  <!-- Parameterized gates -->
  <rect x="60" y="75" width="28" height="20" class="gate gate-param"/>
  <text x="74" y="85" class="gate-text">Ry(θ₁)</text>
  <rect x="60" y="105" width="28" height="20" class="gate gate-param"/>
  <text x="74" y="115" class="gate-text">Ry(θ₂)</text>
  <rect x="60" y="135" width="28" height="20" class="gate gate-param"/>
  <text x="74" y="145" class="gate-text">Ry(θ₃)</text>

  <!-- CNOT gates -->
  <circle cx="105" cy="85" r="4" fill="#666"/>
  <line x1="105" y1="89" x2="105" y2="111" stroke="#666" stroke-width="1.5"/>
  <circle cx="105" cy="115" r="8" fill="none" stroke="#666" stroke-width="1.5"/>
  <line x1="97" y1="115" x2="113" y2="115" stroke="#666" stroke-width="1.5"/>

  <circle cx="125" cy="115" r="4" fill="#666"/>
  <line x1="125" y1="119" x2="125" y2="141" stroke="#666" stroke-width="1.5"/>
  <circle cx="125" cy="145" r="8" fill="none" stroke="#666" stroke-width="1.5"/>
  <line x1="117" y1="145" x2="133" y2="145" stroke="#666" stroke-width="1.5"/>

  <!-- More parameterized gates -->
  <rect x="145" y="75" width="28" height="20" class="gate gate-param"/>
  <text x="159" y="85" class="gate-text">Rz(θ₄)</text>
  <rect x="145" y="105" width="28" height="20" class="gate gate-param"/>
  <text x="159" y="115" class="gate-text">Rz(θ₅)</text>

  <!-- Measurement -->
  <g transform="translate(185, 77)">
    <rect x="0" y="0" width="16" height="14" fill="white" stroke="#666" stroke-width="1"/>
    <path d="M2,10 Q8,3 14,10" stroke="#666" stroke-width="1" fill="none"/>
  </g>
  <g transform="translate(185, 107)">
    <rect x="0" y="0" width="16" height="14" fill="white" stroke="#666" stroke-width="1"/>
    <path d="M2,10 Q8,3 14,10" stroke="#666" stroke-width="1" fill="none"/>
  </g>
  <g transform="translate(185, 137)">
    <rect x="0" y="0" width="16" height="14" fill="white" stroke="#666" stroke-width="1"/>
    <path d="M2,10 Q8,3 14,10" stroke="#666" stroke-width="1" fill="none"/>
  </g>

  <!-- Arrow to measurement box -->
  <path d="M220,115 L250,115" class="arrow"/>

  <!-- Measurement/Expectation Box -->
  <rect x="255" y="85" width="80" height="60" class="box"/>
  <text x="295" y="108" text-anchor="middle" class="label" style="font-size: 10px;">Measure</text>
  <text x="295" y="122" text-anchor="middle" class="label" style="font-size: 10px;">⟨ψ(θ)|H|ψ(θ)⟩</text>
  <text x="295" y="138" text-anchor="middle" class="label" style="font-size: 9px; fill: #666;">= E(θ)</text>

  <!-- Arrow to optimizer -->
  <path d="M335,115 L365,115" class="arrow"/>

  <!-- Classical Optimizer Box -->
  <rect x="370" y="75" width="70" height="80" class="box" style="fill: #e8f5e8;"/>
  <text x="405" y="100" text-anchor="middle" class="label" style="font-size: 10px;">Classical</text>
  <text x="405" y="115" text-anchor="middle" class="label" style="font-size: 10px;">Optimizer</text>
  <text x="405" y="135" text-anchor="middle" class="label" style="font-size: 9px; fill: #666;">min E(θ)</text>

  <!-- Feedback loop -->
  <path d="M405,155 L405,200 L120,200 L120,165" class="loop-arrow"/>
  <text x="260" y="215" text-anchor="middle" class="label" style="font-size: 10px; fill: #2a6a3a;">Update parameters θ</text>

  <!-- Legend -->
  <rect x="20" y="220" width="12" height="12" class="gate gate-param"/>
  <text x="38" y="230" class="label" style="font-size: 9px;">Parameterized gate</text>
</svg>
